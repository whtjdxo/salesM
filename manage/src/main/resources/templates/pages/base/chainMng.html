<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{layouts/default}" layout:fragment="Content">
  <head>
    <title>가맹점 관리</title>
    <script src="/vendors/tinymce/tinymce.min.js"></script>
    <script src="/vendors/datatables.net/dataTables.min.js"></script>
    <script src="/vendors/datatables.net-bs5/dataTables.bootstrap5.min.js"></script>
    <script src="/vendors/datatables.net-fixedcolumns/dataTables.fixedColumns.min.js"></script>
    <script src="/vendors/dropzone/dropzone-min.js"></script>
    <script src="/js/jquery.form.js"></script>
    <link rel="stylesheet" href="/vendors/datatables.net-bs5/dataTables.bootstrap5.min.css" />
    <script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
    <!-- DataTables Select CSS 추가 -->
    <link rel="stylesheet" href="/css/custom-salesm.css" />

    <script th:inline="none">      
      function execDaumPostcode(target) {
        new daum.Postcode({
          oncomplete: function (data) {
            var roadAddr = data.roadAddress;
            if (target == 'corp') {
              document.getElementById('chain_addr').value = roadAddr;
              document.getElementById('chain_zip_no').value = data.zonecode;
            } else if (target == 'ceo') {
              document.getElementById('ceo_addr').value = roadAddr;
              document.getElementById('ceo_zip_no').value = data.zonecode;
            }
          },
        }).open();
      }
      $(document).ready(function () {           
        $('#frm_chain_info').onLoadFunction();     
        $('#frm_cont_info').onLoadFunction();     
        $('#frm_van_info').onLoadFunction(); 
        $('#frm_card_info').onLoadFunction(); 
        $('#frm_file_info').onLoadFunction(); 

        
        callAjax('/common/totalCodelist', "code_grp_cd=('BANK_CD') AND CHK_CD1 = 'COLL'", fn_abank_setting);      
        function fn_abank_setting(data) {
          codeSetting('BANK_CD', data.data, '#abank_cd', '1', '', ''); 
        }

        callAjax('/common/totalCodelist', "code_grp_cd=('BANK_CD')", fn_bbank_setting);      
        function fn_bbank_setting(data) {          
          codeSetting('BANK_CD', data.data, '#bbank_cd', '1', '', '');
        }
        
        callAjax('/common/getCreditCorpList', "", fn_credit_list_setting);      
        function fn_credit_list_setting(data) { 
          codeSetting('CORP_CD', data.data, '#sch_corp_cd', '1', '', '');          
          codeSetting('CORP_CD', data.data, '#corp_cd', '1', '', '');
        }

        callAjax('/common/getAgencyList', "", fn_agency_list_setting);
        function fn_agency_list_setting(data) {
          codeSetting('AGENCY_NO', data.data, '#sch_agency_no', '1', '', '');
          codeSetting('AGENCY_NO', data.data, '#agency_no', '1', '', '');
        }

        callAjax('/common/totalCodelist', "code_grp_cd=('SVC_STAT')", fn_svc_stat_setting);      
        function fn_svc_stat_setting(data) {
          codeSetting('SVC_STAT', data.data, '#sch_svc_stat', '1', '', '');
          codeSetting('SVC_STAT', data.data, '#svc_stat', '1', '', '');
        }

        callAjax('/common/totalCodelist', "code_grp_cd=('REMIT_OVER_STAT_CD')", fn_remit_over_stat_cd_setting);      
        function fn_remit_over_stat_cd_setting(data) {
          codeSetting('REMIT_OVER_STAT_CD', data.data, '#remit_over_stat_cd', '1', '', '');
        }

        callAjax('/common/totalCodelist', "code_grp_cd=('RISK_REASON_CD')", fn_risk_reason_cd_setting);      
        function fn_risk_reason_cd_setting(data) {
          codeSetting('RISK_REASON_CD', data.data, '#risk_reason_cd', '1', '', '');
        }

        callAjax('/common/totalCodelist', "code_grp_cd=('ACCOUNT_TP')", fn_account_tp_setting);      
        function fn_account_tp_setting(data) {
          codeSetting('ACCOUNT_TP', data.data, '#abank_account_tp', '1', '', '');
        }

        callAjax('/common/totalCodelist', "code_grp_cd=('ABANK_LINK_STAT')", fn_abank_link_setting);      
        function fn_abank_link_setting(data) {
          codeSetting('ABANK_LINK_STAT', data.data, '#abank_link_stat', '1', '', '');
        }

        callAjax('/common/totalCodelist', "code_grp_cd=('VAN_CD')", fn_van_cd_setting);      
        function fn_van_cd_setting(data) {
          codeSetting('VAN_CD', data.data, '#van_cd', '1', '', '');
        }

        callAjax('/common/totalCodelist', "code_grp_cd=('CARD_ACQ')", fn_card_acq_setting);      
        function fn_card_acq_setting(data) {
          codeSetting('CARD_ACQ', data.data, '#card_acq', '1', '', '');
        }

        callAjax('/common/totalCodelist', "code_grp_cd=('FILE_GB')", fn_file_gb_setting);      
        function fn_file_gb_setting(data) {
          codeSetting('FILE_GB', data.data, '#file_gb', '1', '', '');
        }        
        var tbl_chain = $('#tbl_chain').DataTable({
          processing: true,
          serverSide: true,
          select: true,
          responsive: true,
          ajax: {
            url: '/base/organ/chainMng/list',
            contentType: 'application/json',
            dataType: 'JSON',
            type: 'POST',            
            data: function (postData) {
              formData = $('#frm_sch').serializeObject();
              Object.assign(postData, formData);
              return JSON.stringify(postData);
            },
          },
            columns: [
                { data: 'chain_no' }
                , { data: 'chain_nm' }
                , { data: 'biz_no' }                
                , { data: 'ceo_nm' }
                , { data: 'ceo_tel_no' }
                , { data: 'tot_limit_amt' }
                , { data: 'tot_use_amt' }
                , { data: 'corp_nm' }
                , { data: 'agency_nm' }
                , { data: 'svc_stat_nm' }
                , { data: 'remit_stat_nm' }                
              ],
            columnDefs: [           
            { targets: 0, width: '90px', className: 'text-center' },
            { targets: 1, width: '', className: 'text-left' },
            { targets: 2, width: '110px', className: 'text-center' },
            { targets: 3, width: '90px', className: 'text-center' },
            { targets: 4, width: '110PX', className: 'text-center' },
            { targets: 5, width: '120PX', className: 'text-end' , render: $.fn.dataTable.render.number(',', '.', 0, '')},
            { targets: 6, width: '120PX', className: 'text-end' , render: $.fn.dataTable.render.number(',', '.', 0, '')},
            { targets: 7, width: '90px', className: 'text-center' },
            { targets: 8, width: '90px', className: 'text-center' },
            { targets: 9, width: '80px', className: 'text-center' },
            { targets: 10, width: '80px', className: 'text-center' },
          ],  
          order: [[1, 'desc']],
          paging: true,
          lengthChange: false,
          searching: false,
          ordering: true,
          autoWidth: false,
          responsive: true,
          scrollCollapse: true,
          pageLength: 20,
          scrollY: '580px',
          info: false,
          language: {
            emptyTable: '데이터가 없습니다.',
            search: '검색:',
            zeroRecords: '일치하는 데이터가 없습니다.',
            loadingRecords: '로딩중...',
            processing: '처리중...',
          },
        });

        $('#btn_search').click(function () {
          fn_chain_form_clear();
          tbl_chain.ajax.reload();
        });
        
        $('#tbl_chain').on('click', 'tr', function () { 
          if ($(this).hasClass('selected')) {
            $(this).removeClass('selected');
          } else {
            tbl_chain.$('tr.selected').removeClass('selected');
            $(this).addClass('selected');
          }
          var data = tbl_chain.row(this).data();
          if (data) {
            $('#frm_chain_info')[0].reset(); 
            $('#frm_cont_info')[0].reset();
            $('#frm_van_info')[0].reset();
            $('#frm_card_info')[0].reset();
            $('#frm_link_chain')[0].reset();
            $('#frm_file_info')[0].reset();
            
            $('#corp_cd').val(data.corp_cd);              
            $('#agency_no').val(data.agency_no);    
            $('#chain_no').val(data.chain_no);            
            $('#cont_chain_no').val(data.chain_no);            
            $('#van_chain_no').val(data.chain_no);            
            $('#card_chain_no').val(data.chain_no);            
            $('#link_org_chain_no').val(data.chain_no);
            $('#file_chain_no').val(data.chain_no); 

            $('#chain_nm').val(data.chain_nm);
            $('#biz_no').val(data.biz_no);
            $('#upjong').val(data.upjong);            
            $('#uptae').val(data.uptae);
            $('#chain_zip_no').val(data.chain_zip_no);
            $('#cont_dt').val(data.cont_dt);
            $('#chain_addr').val(data.chain_addr);
            $('#chain_addr_dtl').val(data.chain_addr_dtl);
            $('#chain_tel_no').val(data.chain_tel_no);
            
            $('#ceo_id').val(data.ceo_id);
            $('#ceo_birth_dt').val(data.ceo_birth_dt);
            $('#ceo_regno').val(data.ceo_regno);
            $('#ceo_nm').val(data.ceo_nm);
            $('#ceo_zip_no').val(data.ceo_zip_no);
            $('#ceo_addr').val(data.ceo_addr);
            $('#ceo_addr_dtl').val(data.ceo_addr_dtl);            
            $('#ceo_tel_no').val(data.ceo_tel_no);            
            $('#email').val(data.email);
            $('#remark').val(data.remark);
            
            $('#svc_stat').val(data.svc_stat);
            $('#svc_start_dt').val(data.svc_start_dt);
            $('#svc_end_dt').val(data.svc_end_dt);


            $('#crd_fee_rate').val(data.crd_fee_rate);
            $('#crd_delay_rate').val(data.crd_delay_rate);
            $('#svc_fee_rate').val(data.svc_fee_rate);
            $('#etc_fee_rate').val(data.etc_fee_rate);
            $('#day_use_rate').val(data.day_use_rate);
            $('#day_use_amt').val(data.day_use_amt); 
            $('#tot_limit_amt').val(data.tot_limit_amt);
            $('#unit_limit_amt').val(data.unit_limit_amt);
            $('#day_use_rate').val(data.day_use_rate);
            
            $('#abank_cd').val(data.abank_cd);
            $('#abank_account_no').val(data.abank_account_no);
            $('#abank_depositor').val(data.abank_depositor);
            $('#remit_trans_fee').val(data.remit_trans_fee);
            $('#abank_pwd').val(data.abank_pwd);
            $('#abank_account_tp').val(data.abank_account_tp);
            $('#abank_speed_yn').val(data.abank_speed_yn);
            $('#abank_link_stat').val(data.abank_link_stat);
            $('#abank_link_agree_dt').val(data.abank_link_agree_dt);
            $('#abank_search_id').val(data.abank_search_id);
            $('#abank_search_pwd').val(data.abank_search_pwd);

            $('#bbank_cd').val(data.bbank_cd);
            $('#bbank_account_no').val(data.bbank_account_no);
            $('#bbank_depositor').val(data.bbank_depositor);
            $('#remit_trans_fee').val(data.remit_trans_fee);
            
            $('#remit_stat').val(data.remit_stat);
            $('#remit_start_dt').val(data.remit_start_dt);  
            $('#remit_stat_cd').val(data.remit_stat_cd);
            $('#remit_over_stat').val(data.remit_over_stat);

            $('#risk_stat').val(data.risk_stat);
            $('#risk_reason_cd').val(data.risk_reason_cd);            
            
            $('#cardsales_id').val(data.cardsales_id);
            $('#cardsales_pwd').val(data.cardsales_pwd);
            $("input:radio[name='use_yn'][value='" + data.use_yn + "']").prop('checked', true); 
            $('#upt_user_id').val(data.upt_user_id);
            $('#upt_dttm').val(data.upt_dttm);   

            $('#btn_update').show();
            $('#btn_save').hide();            
            $('#btn_dupchk').hide();

            $('#ceo_pwd').removeAttr("required");
            $('#ceo_id').attr("readonly", "readonly");            
            // $('#ceo_pwd').attr("required", "required");            

            if(data.abank_cd=="039"){
              $('#knbank_info').show();
              $('#abank_link_agree_dt').attr("required", "required");            
              $('#abank_link_stat').attr("required", "required");            
            }else{
              $('#knbank_info').hide();
              $('#abank_link_agree_dt').removeAttr("required");
              $('#abank_link_stat').removeAttr("required");
            }

            $('#crud').val('update'); 
            tbl_van.ajax.reload();   
            tbl_card.ajax.reload(); 
            tbl_link_chain.ajax.reload();
            tbl_file.ajax.reload();                         
          }  
        });      

        $('#btn_clear').click(function () {
          fn_chain_form_clear();
        }); 

        function fn_chain_form_clear(){
          $('#frm_chain_info')[0].reset();
          $('#frm_cont_info')[0].reset();
          $('#frm_van_info')[0].reset();
          $('#frm_card_info')[0].reset();
          $('#frm_file_info')[0].reset();

          $('#tbl_van tbody').empty();
          $('#tbl_card tbody').empty();
          $('#tbl_file tbody').empty(); 
          
          $("input:radio[name='use_yn'][value='Y']").prop('checked', true);
          $('#btn_update').hide();
          $('#btn_save').show();
          $('#btn_dupchk').show(); 
          $('#ceo_pwd').attr("required", "required");
          $('#ceo_id').removeAttr("readonly");
          $('#ceo_id_dup_chk').val("N");
        }

        $('#btn_dupchk').click(function () {
          var ceo_id = $('#ceo_id').val();  
          if (ceo_id == '') {
            swal('실패', '대표자 ID를 입력하세요.', 'error');
            return;
          } else {
            callAjax('/base/user/userMng/getUserIdDupChk', 'user_id=' + ceo_id, fn_ceo_dupchk);
          }
        });
        function fn_ceo_dupchk(data) {
          var resultCode = data.resultCode;
          var resultMsg = data.resultMsg;
          if (resultCode == 'S000') {
            swal('성공', '사용가능한 대표자 ID입니다.', 'success');
            $('#ceo_id_dup_chk').val("Y");
          } else {
            swal('실패', resultMsg, 'error');
          }
        } 

        $('#btn_save').click(function () {
          $('#crud').val('create');
          var form = $('#frm_chain_info');
          var checked = true;
          $.each(form, function (i, val) {
            if (!val.checkValidity()) {
              checked = false;
            }
          });

          var idDupChk = $('#ceo_id_dup_chk').val();
          if(idDupChk == "N" || idDupChk ==''){
            swal('확인', '대표자 ID 중복체크를 해주세요요.', 'success');
            return;
          }
          if (checked) {
            ConfirmdialogToAjax('create', '/base/organ/chainMng/insertChain', $('#frm_chain_info').serialize(), fn_return_result);
          } 
        });

        $('#btn_update').click(function () {
          $('#crud').val('update');
          var form = $('#frm_chain_info');
          var checked = true;
          var chain_no = $('#chain_no').val();
          if(chain_no == '') {
            swal('실패', "가맹점을 먼저 선택해주세요.", 'error');
            checked = false;
            return;
          }

          $.each(form, function (i, val) {
            if (!val.checkValidity()) {
              checked = false;
            }
          });
          
          if (checked) {
            ConfirmdialogToAjax('update', '/base/organ/chainMng/updateChain', $('#frm_chain_info').serialize(), fn_return_result);
          }
        });    

        $('#btn_cont_update').click(function () {
          $('#crud').val('update');
          var chain_no = $('#cont_chain_no').val();          
          var checked = true; 
          if(chain_no == '') {
            swal('확인', "가맹점을 먼저 선택해주세요.", 'error');
            checked = false;
            return;
          }
          var form = $('#frm_cont_info');
          $.each(form, function (i, val) {
            if (!val.checkValidity()) {
              checked = false;
            }
          });

          if (checked) {
            ConfirmdialogToAjax('update', '/base/organ/chainMng/updateChainCont', $('#frm_cont_info').serialize(), fn_return_result);
          }
        }); 

        function fn_return_result(data) {
          var resultCode = data.resultCode;
          var resultMsg = data.resultMsg;
          if (resultCode == 'S000') {
            fn_chain_form_clear();
            swal('성공', '작업을 정상적으로 완료하였습니다.', 'success');
            tbl_chain.ajax.reload();                 
          } else {
            swal('실패', resultMsg, 'error');
          }
        }
        // --------------------------------------------------------------- frm_van_info 정보 처리 ---------------------------------------------------
        var tbl_van = $('#tbl_van').DataTable({
            processing: true,
            serverSide: true,
            select: true,
            responsive: true,
            ajax: {
              url: '/base/organ/chainMng/vanList',
              contentType: 'application/json',
              dataType: 'JSON',
              type: 'POST',
              data: function (postData) {
                formData = $('#frm_van_info').serializeObject();
                Object.assign(postData, formData);
                return JSON.stringify(postData);
              },
            },
              columns: [
                  { data: 'van_cd' }
                  , { data: 'van_nm' }
                  , { data: 'van_id' }
                  , { data: 'use_yn' }
                ],
              columnDefs: [
              { targets: 0, width: '90px', className: 'text-center' },
              { targets: 1, width: '120px', className: 'text-start' },
              { targets: 2, width: '120px', className: 'text-center' },
              { targets: 3, width: '80px', className: 'text-center' },
            ],
            order: [[1, 'desc']],
            paging: true,
            lengthChange: false,
            searching: false,
            ordering: true,
            autoWidth: false,
            responsive: true,
            scrollCollapse: true,
            pageLength: 10,
            scrollY: '450px',
            info: false,
            language: {
              emptyTable: '데이터가 없습니다.',
              search: '검색:',
              zeroRecords: '일치하는 데이터가 없습니다.',
              loadingRecords: '로딩중...',
              processing: '처리중...',
            },
          }); 

        $('#tbl_van').on('click', 'tr', function () {
          if ($(this).hasClass('selected')) {
            $(this).removeClass('selected');
          } else {
            tbl_van.$('tr.selected').removeClass('selected');
            $(this).addClass('selected');
          }
          var data = tbl_van.row(this).data();
          if (data) {
            $('#frm_van_info')[0].reset();             
            $('#van_seq').val(data.van_seq);
            $('#van_chain_no').val(data.chain_no);
            $('#van_cd').val(data.van_cd);
            $('#van_id').val(data.van_id);
            $('#van_pwd').val(data.van_pwd);
            $('#term_id').val(data.term_id);       
            $('#van_use_yn').val(data.use_yn);       
            $('#van_upt_user_id').val(data.upt_user_id);
            $('#van_upt_dttm').val(data.upt_dttm);   

            $('#btn_van_update').show();
            $('#btn_van_create').hide();            
            $('#btn_van_dupchk').hide(); 
          }  
        });      

        $('#btn_van_clear').click(function () {     
          fn_frm_van_info_clear(); 
        });

        function fn_frm_van_info_clear(){
          var van_chain_no = $('#van_chain_no').val(); 
          $('#frm_van_info')[0].reset();
          $('#btn_van_update').hide();
          $('#btn_van_create').show();            
          $('#btn_van_dupchk').show();     
          $('#van_id_dup_chk').val("N");        
          $('#van_chain_no').val(van_chain_no);
        }

        $('#btn_van_dupchk').click(function () {
          var chain_no = $('#van_chain_no').val();
          var van_cd = $('#van_cd').val();
          var van_id = $('#van_id').val();  
          if (chain_no == '' ) {
            swal('실패', '가맹점을 먼저 선택하세요.', 'error');
            return;
          }
          if ( van_cd == '') {
            swal('실패', 'VAN 사를 선택하세요.', 'error');
            return;
          }

          if (van_id == '' ) {
            swal('실패', 'VAN ID를 정확히 입력하세요.', 'error');
            return;
          } 
          var params = {
              chain_no: chain_no,
              van_cd: van_cd,
              van_id: van_id
            };
          callAjaxJson('/base/organ/chainMng/getVanIdDupChk', params, fn_vanid_dupchk);          
        });

        function fn_vanid_dupchk(data) {
          var resultCode = data.resultCode;
          var resultMsg = data.resultMsg;
          if (resultCode == 'S000') {
            swal('성공', '사용가능한 VAN ID입니다.', 'success');
            $('#van_id_dup_chk').val("Y");        
          } else {
            swal('실패', resultMsg, 'error');
          }
        }

        $('#remit_over_stat').change(function(){
          if($('#remit_over_stat').val() =='Y'){
            $('#remit_over_stat_cd').attr("disabled", "disabled");
            $('#remit_over_stat_cd').removeAttr("required");   
          } else{
            $('#remit_over_stat_cd').removeAttr("disabled");     
            $('#remit_over_stat_cd').attr("required", "required");            
          }
        });

        $('#risk_stat').change(function(){
          if($('#risk_stat').val() =='S'){
            $('#risk_reason_cd').attr("disabled", "disabled");
            $('#risk_reason_cd').removeAttr("required");   
          } else{
            $('#risk_reason_cd').removeAttr("disabled");     
            $('#risk_reason_cd').attr("required", "required");            
          }
        });
        
        $('#btn_van_create').click(function () {    
          $('#crud').val('create');      
          var form = $('#frm_van_info');
          var checked = true;
          var chain_no = $('#van_chain_no').val();
          var idDupChk = $('#van_id_dup_chk').val();
          if(chain_no == '') {
            swal('확인', "가맹점을 먼저 선택해주세요.", 'error');
            checked = false;
            return;
          }

          $.each(form, function (i, val) {
            if (!val.checkValidity()) {
              checked = false;
            }
          });

          if(idDupChk=='N' || idDupChk == ''){
            swal('확인', "VAN ID 중복체크를 해주세요.", 'error');
            checked = false;
            return;
          }

          if (checked) {
            ConfirmdialogToAjax('create', '/base/organ/chainMng/insertChainVan', $('#frm_van_info').serialize(), fn_van_return_result);
          } 
        });

        $('#btn_van_update').click(function () {
          $('#crud').val('update');
          var form = $('#frm_van_info');
          var checked = true;
          var van_seq = $('#van_seq').val();
          if(chain_no == '') {
            swal('실패', "Van ID를 먼저 선택해주세요.", 'error');
            checked = false;
            return;
          }
          var chain_no = $('#van_chain_no').val();
          if(chain_no == '') {
            swal('확인', "가맹점을 먼저 선택해주세요.", 'error');
            checked = false;
            return;
          }

          $.each(form, function (i, val) {
            if (!val.checkValidity()) {
              checked = false;
            }
          });
          
          if (checked) {
            ConfirmdialogToAjax('update', '/base/organ/chainMng/updateChainVan', $('#frm_van_info').serialize(), fn_van_return_result);
          }
        });     

        function fn_van_return_result(data) {
          var resultCode = data.resultCode;
          var resultMsg = data.resultMsg; 
          if (resultCode == 'S000') {
            fn_frm_van_info_clear();
            swal('성공', '작업을 정상적으로 완료하였습니다.', 'success');
            tbl_van.ajax.reload();                 
          } else {
            swal('실패', resultMsg, 'error');
          }
        }

        // --------------------------------------------------------------- frm_card_info 정보 처리 ---------------------------------------------------
        var tbl_card = $('#tbl_card').DataTable({
            processing: true,
            serverSide: true,
            select: true,           
            ajax: {
              url: '/base/organ/chainMng/cardList',
              contentType: 'application/json',
              dataType: 'JSON',
              type: 'POST',
              data: function (postData) {
                formData = $('#frm_card_info').serializeObject();
                Object.assign(postData, formData);
                return JSON.stringify(postData);
              },
            },
            columns: [
                  { data: 'card_acq_nm' }
                , { data: 'card_rate' }
                , { data: 'check_rate' }
                , { data: 'abroad_rate' }
                , { data: 'card_in_cycle' }
                , { data: 'depo_chk' }
                , { data: 'use_yn' }
              ],
            columnDefs: [
            { targets: 0, width: '120px', className: 'text-center' },
            { targets: 1, width: '70px', className: 'text-right' },
            { targets: 2, width: '70px', className: 'text-right' },
            { targets: 3, width: '70px', className: 'text-right' },
            { targets: 4, width: '70px', className: 'text-right' },
            { targets: 5, width: '70px', className: 'text-center' }, 
            { targets: 6, width: '70px', className: 'text-center' },
            ],
            order: [[1, 'desc']],
            paging: true,
            lengthChange: false,
            searching: false,
            ordering: true,
            responsive: true,
            autoWidth: false,
            scrollX: true ,
            scrollCollapse: true,
            pageLength: 10,
            scrollY: '450px',
            info: false,
            language: {
              emptyTable: '데이터가 없습니다.',
              search: '검색:',
              zeroRecords: '일치하는 데이터가 없습니다.',
              loadingRecords: '로딩중...',
              processing: '처리중...',
            },
          }); 

        $('#tbl_card').on('click', 'tr', function () {
          if ($(this).hasClass('selected')) {
            $(this).removeClass('selected');
          } else {
            tbl_card.$('tr.selected').removeClass('selected');
            $(this).addClass('selected');
          }
          var data = tbl_card.row(this).data();
          if (data) {
            $('#frm_card_info')[0].reset();             
            $('#card_seq').val(data.card_seq);
            $('#card_chain_no').val(data.chain_no);
            $('#card_acq').val(data.card_acq);        
            $('#card_reg_no').val(data.card_reg_no);
                   
            $('#depo_chk').val(data.depo_chk);       
            $('#card_use_yn').val(data.use_yn);       

            $('#card_rate').val(data.card_rate);
            $('#check_rate').val(data.check_rate);
            $('#abroad_rate').val(data.abroad_rate);       
            $('#card_in_cycle').val(data.card_in_cycle);

            $('#card_memo').val(data.card_memo);    
            $('#card_upt_user_id').val(data.upt_user_id);
            $('#card_upt_dttm').val(data.upt_dttm);   

            $('#btn_card_update').show();
            $('#btn_card_create').hide();            
            $('#btn_card_dupchk').hide(); 
          }  
        });      

        $('#btn_card_clear').click(function () {     
          fn_frm_card_info_clear(); 
        });

        function fn_frm_card_info_clear(){
          var card_chain_no = $('#card_chain_no').val(); 
          $('#frm_card_info')[0].reset();
          $('#btn_card_update').hide();
          $('#btn_card_create').show();            
          $('#btn_card_dupchk').show();           
          $('#card_id_dup_chk').val("N");
          $('#card_chain_no').val(card_chain_no);
        }

        $('#card_reg_no').on('change', function() {
          var chk = $('#card_id_dup_chk').val();
          if (chk == "Y") {
            $('#card_id_dup_chk').val("N");
            $('#btn_card_dupchk').show();             
          } 
        });

        $('#btn_card_dupchk').click(function () {
          var chain_no = $('#card_chain_no').val();
          var card_acq = $('#card_acq').val();
          var card_reg_no = $('#card_reg_no').val();  
          if (chain_no == '' ) {
            swal('확인', '가맹점을 먼저 선택하세요.', 'error');
            return;
          }
          if ( card_acq == '') {
            swal('확인', '카드(매입사)를 선택하세요.', 'error');
            return;
          }

          if (card_reg_no == '' ) {
            swal('확인', '가맹번호를 정확히 입력하세요.', 'error');
            return;
          } 

          var params = {
              chain_no: chain_no,
              card_acq: card_acq,
              card_reg_no: card_reg_no
            };

          callAjaxJson('/base/organ/chainMng/getCardDupChk', params, fn_cardid_dupchk);          
        });

        function fn_cardid_dupchk(data) {
          var resultCode = data.resultCode;
          var resultMsg = data.resultMsg;
          if (resultCode == 'S000') {
            swal('성공', '사용 가능한 가맹번호 입니다.', 'success');
            $('#card_id_dup_chk').val("Y");
          } else {
            swal('실패', resultMsg, 'error');
          }
        }
        
        $('#btn_card_create').click(function () {               
          $('#crud').val('create');      
          var form = $('#frm_card_info');
          var checked = true;
          var chain_no = $('#card_chain_no').val();
          var idDupChk = $('#card_id_dup_chk').val();
          if(chain_no == '') {
            swal('실패', "가맹점을 먼저 선택해주세요.", 'error');
            checked = false;
            return;
          }

          $.each(form, function (i, val) {
            if (!val.checkValidity()) {
              checked = false;
            }
          });
          if(idDupChk=='N' || idDupChk == ''){
            swal('확인', "가맹점 번호 중복 체크를 해주세요.", 'error');
            checked = false;
            return;
          }
          if (checked) {
            ConfirmdialogToAjax('create', '/base/organ/chainMng/insertChainCard', $('#frm_card_info').serialize(), fn_card_return_result);
          } 
        });

        $('#btn_card_update').click(function () {
          $('#crud').val('update');
          var form = $('#frm_card_info');
          var checked = true;
          var card_seq = $('#card_seq').val();
          if(chain_no == '') {
            swal('실패', "카드사를 먼저 선택해주세요.", 'error');
            checked = false;
            return;
          }
          var chain_no = $('#card_chain_no').val();
          if(chain_no == '') {
            swal('실패', "가맹점을 먼저 선택해주세요.", 'error');
            checked = false;
            return;
          }

          $.each(form, function (i, val) {
            if (!val.checkValidity()) {
              checked = false;
            }
          });
          
          if (checked) {
            ConfirmdialogToAjax('update', '/base/organ/chainMng/updateChainCard', $('#frm_card_info').serialize(), fn_card_return_result);
          }
        });     

        function fn_card_return_result(data) {
          var resultCode = data.resultCode;
          var resultMsg = data.resultMsg; 
          if (resultCode == 'S000') {
            fn_frm_card_info_clear();
            swal('성공', '작업을 정상적으로 완료하였습니다.', 'success');
            tbl_card.ajax.reload();                 
          } else {
            swal('실패', resultMsg, 'error');
          }
        }  
        
        // --------------------------------------------------------------- frm_link_chain 정보 처리 ---------------------------------------------------        
        var tbl_link_chain = $('#tbl_link_chain').DataTable({
            processing: true,
            serverSide: true,
            select: true,           
            ajax: {
              url: '/base/organ/chainMng/linkChainList',
              contentType: 'application/json',
              dataType: 'JSON',
              type: 'POST',
              data: function (postData) {
                formData = $('#frm_link_chain').serializeObject();
                Object.assign(postData, formData);
                return JSON.stringify(postData);
              },
            },
            columns: [
                  { data: 'link_chain_no' }
                , { data: 'link_chain_nm' }
                , { data: 'ceo_nm' }
                , { data: 'chain_tel_no' }                
              ],
            columnDefs: [
            { targets: 0, width: '120px', className: 'text-center' },
            { targets: 1, width: '150px', className: 'text-center' },
            { targets: 2, width: '90px', className: 'text-center' },
            { targets: 3, width: '120px', className: 'text-center' },
            ],
            order: [[1, 'desc']],
            paging: true,
            lengthChange: false,
            searching: false,
            ordering: true,
            responsive: true,
            autoWidth: false,
            scrollX: true ,
            scrollCollapse: true,
            pageLength: 10,
            scrollY: '450px',
            info: false,
            language: {
              emptyTable: '데이터가 없습니다.',
              search: '검색:',
              zeroRecords: '일치하는 데이터가 없습니다.',
              loadingRecords: '로딩중...',
              processing: '처리중...',
            },
          }); 

        $('#tbl_link_chain').on('click', 'tr', function () {
          if ($(this).hasClass('selected')) {
            $(this).removeClass('selected');
          } else {
            tbl_card.$('tr.selected').removeClass('selected');
            $(this).addClass('selected');
          }
          var data = tbl_link_chain.row(this).data();
          if (data) {
            $('#frm_link_chain')[0].reset();  
            $('#link_chain_no').val(data.link_chain_no);
            $('#link_chain_nm').val(data.link_chain_nm);
            $('#link_memo').val(data.memo);
            $('#link_use_yn').val(data.use_yn); 
            $('#link_upt_user_id').val(data.upt_user_id);
            $('#link_upt_dttm').val(data.upt_dttm);   

            $('#btn_link_update').show();
            $('#btn_link_create').hide();            
            $('#btn_link_dupchk').hide(); 
          }  
        });      

        $('#btn_link_clear').click(function () {     
          fn_frm_link_chain_clear(); 
        });

        function fn_frm_link_chain_clear(){
          var link_org_chain_no = $('#link_org_chain_no').val(); 
          $('#frm_link_chain')[0].reset();
          $('#btn_link_update').hide();
          $('#btn_link_create').show();           
          $('#link_org_chain_no').val(link_org_chain_no);
        }

        $('#btn_link_create').click(function () {               
          $('#crud').val('create');      
          var form = $('#frm_link_info');
          var checked = true;
          var chain_no = $('#link_org_chain_no').val();
          if(chain_no == '') {
            swal('실패', "가맹점을 먼저 선택해주세요.", 'error');
            checked = false;
            return;
          }

          $.each(form, function (i, val) {
            if (!val.checkValidity()) {
              checked = false;
            }
          });          
          if (checked) {
            ConfirmdialogToAjax('create', '/base/organ/chainMng/insertLinkChain', $('#frm_link_chain').serialize(), fn_link_return_result);
          } 
        });

        $('#btn_link_update').click(function () {
          $('#crud').val('update');
          var form = $('#frm_link_info');
          var checked = true;           
          var chain_no = $('#link_org_chain_no').val();
          if(chain_no == '') {
            swal('실패', "가맹점을 먼저 선택해주세요.", 'error');
            checked = false;
            return;
          }

          $.each(form, function (i, val) {
            if (!val.checkValidity()) {
              checked = false;
            }
          });
          
          if (checked) {
            ConfirmdialogToAjax('update', '/base/organ/chainMng/updateLinkChain', $('#frm_link_chain').serialize(), fn_link_return_result);
          }
        });     

        function fn_link_return_result(data) {
          var resultCode = data.resultCode;
          var resultMsg = data.resultMsg; 
          if (resultCode == 'S000') {
            fn_frm_link_info_clear();
            swal('성공', '작업을 정상적으로 완료하였습니다.', 'success');
            tbl_card.ajax.reload();                 
          } else {
            swal('실패', resultMsg, 'error');
          }
        }

        // --------------------------------------------------------------- frm_file_info 정보 처리 ---------------------------------------------------
        var tbl_file = $('#tbl_file').DataTable({
            processing: true,
            serverSide: true,
            select: true,           
            ajax: {
              url: '/base/organ/chainMng/fileList',
              contentType: 'application/json',
              dataType: 'JSON',
              type: 'POST',
              data: function (postData) {
                formData = $('#frm_file_info').serializeObject();
                Object.assign(postData, formData);
                return JSON.stringify(postData);
              },
            },
            columns: [
                  { data: 'file_gb_nm' }
                , { data: 'origin_file_nm' }                
              ],
            columnDefs: [
            { targets: 0, width: '120px', className: 'text-center' },
            { targets: 1, width: '250px', className: 'text-right' },            
            ],
            order: [[1, 'desc']],
            paging: true,
            lengthChange: false,
            searching: false,
            ordering: true,
            responsive: false,
            autoWidth: false,
            scrollX: true ,
            scrollCollapse: true,
            pageLength: 10,
            scrollY: '450px',
            info: false,
            language: {
              emptyTable: '데이터가 없습니다.',
              search: '검색:',
              zeroRecords: '일치하는 데이터가 없습니다.',
              loadingRecords: '로딩중...',
              processing: '처리중...',
            },
          }); 

        $('#tbl_file').on('click', 'tr', function () {
          if ($(this).hasClass('selected')) {
            $(this).removeClass('selected');
          } else {
            tbl_file.$('tr.selected').removeClass('selected');
            $(this).addClass('selected');
          }
          var data = tbl_file.row(this).data();
          if (data) {
            $('#frm_file_info')[0].reset();             
            $('#file_seq').val(data.file_seq);
            $('#file_chain_no').val(data.chain_no);
            $('#file_gb').val(data.file_gb);            
            $('#file_nm').val(data.file_nm);            
            
            $('#file_down').attr('href', '/static/upload/' + data.file_path).attr('download', data.origin_file_nm).text(data.origin_file_nm);
            
            $('#file_upt_user_id').val(data.upt_user_id);
            $('#file_upt_dttm').val(data.upt_dttm);   
            
            // $('#file_down').show();
            // $('#file_upload').hide();  
            
            $('#file_down').css("display", "inline");
            $('#file_upload').css("display", "none");
 

            $('#btn_file_delete').show();
            $('#btn_file_create').hide();            
            $('#btn_file_dupchk').hide(); 
          }  
        });      

        $('#btn_file_clear').click(function () {     
          fn_frm_file_info_clear(); 
        });

        function fn_frm_file_info_clear(){
          var file_chain_no = $('#file_chain_no').val();  
          $('#frm_file_info')[0].reset();
          $('#btn_file_delete').hide();
          $('#btn_file_create').show();            
          $('#btn_file_dupchk').show();  
          $('#file_down').hide();
          $('#file_upload').show();          
          $('#file_chain_no').val(file_chain_no);
        }

        $('#btn_file_create').click(function () {     
          $('#crud').val('create');      
          var form = $('#frm_file_info');
          var checked = true;
          var chain_no = $('#file_chain_no').val();
          if(chain_no == '') {
            swal('실패', "가맹점을 먼저 선택해주세요.", 'error');
            checked = false;
            return;
          }
          $.each(form, function (i, val) {
            if (!val.checkValidity()) {
              checked = false;
            }
          });
          if (checked) {
            var formData = new FormData($('#frm_file_info')[0]);
            $.ajax({
                url: '/base/organ/chainMng/insertChainFile',
                type: 'POST',
                data: formData,
                processData: false,
                contentType: false,
                success: function (response) { 
                  console.log("파일 업로드 성공", response);
                  fn_file_return_result(response);   
                },
                error: function (xhr, status, error) {
                  swal('실패', resultMsg, 'error');
                  console.error("파일 업로드 실패", error);
                }
            }); 
          }          
        }); 
 
        $('#btn_file_delete').click(function () {
          $('#crud').val('delete');
          var form = $('#frm_file_info');
          var checked = true;
          var file_seq = $('#file_seq').val();
          if(file_seq == '') {
            swal('실패', "파일을 먼저 선택해주세요.", 'error');
            checked = false;
            return;
          }
          var chain_no = $('#file_chain_no').val();
          if(chain_no == '') {
            swal('실패', "가맹점을 먼저 선택해주세요.", 'error');
            checked = false;
            return;
          } 
          $.each(form, function (i, val) {
            if (!val.checkValidity()) {
              checked = false;
            }
          }); 
          if (checked) {
            ConfirmdialogToAjax('delete', '/base/organ/chainMng/deleteChainFile', $('#frm_file_info').serialize(), fn_file_return_result);
          }
        });     

        function fn_file_return_result(data) {
          var resultCode = data.resultCode;
          var resultMsg = data.resultMsg; 
          if (resultCode == 'S000') {
            fn_frm_link_info_clear();
            swal('성공', '작업을 정상적으로 완료하였습니다.', 'success');
            tbl_card.ajax.reload();                 
          } else {
            swal('실패', resultMsg, 'error');
          }
        } 

        $('#file_upload').change(function (e) {
          var files = e.target.files;
          console.log(files.length);
          if (files.length > 0) {
            var uploadFile = $(this);
            var filename = this.files[0].name;
            var files = !!this.files ? this.files : [];
            var maxSize = 50 * 1024 * 1024;
            var fileSize = files[0].size;

            if (!files.length || !window.FileReader) return;
            var fileExt = filename.slice(filename.indexOf('.') + 1).toLowerCase();
            if (fileSize > maxSize) {
              $('#upload_file').val('');
              swal('경고', '업로드 파일은 50MB까지만 가능합니다.', 'error');
              return;
            }

            var reader = new FileReader();
            reader.readAsDataURL(files[0]);
            reader.onloadend = function () {
              if (files.length > 1) {
                filename = filename + ' 외 ' + (files.length - 1) + '개';
              }
              $('#upload_file').val(filename);
            };
          }
        });

        function fn_file_return_result(data) {
          var resultCode = data.resultCode;
          var resultMsg = data.resultMsg; 
          if (resultCode == 'S000') {
            fn_frm_file_info_clear();
            swal('성공', '작업을 정상적으로 완료하였습니다.', 'success');
            tbl_file.ajax.reload();                 
          } else {
            swal('실패', resultMsg, 'error');
          }
        }

        $('a[data-bs-toggle="tab"]').on('shown.bs.tab', function (e) {
          let targetTab = $(e.target).attr("href"); // 선택된 탭의 href (예: #tab_file_info)
          
          // DataTables를 사용하는 테이블인 경우
          $(targetTab).find('table').each(function () {
            if ($.fn.DataTable.isDataTable(this)) {
              $(this).DataTable().columns.adjust();
            } else {
              $(this).css('width', '100%'); // 일반 테이블인 경우
            }
          });
        });

        $('#btn_help_chain').click(function () {
          var selectedRow = tbl_chain.row('.selected').data();          
          if (!selectedRow) {
            swal('실패', '가맹점을 선택해주세요.', 'error');
            return;
          } 
          $('#sch_help_chain_no').val(selectedRow.chain_no);  
          $('#modal_help_chain').modal('show');
        });
        
        $('#modal_help_chain').on('shown.bs.modal', function() {  
          // 모달 열릴 때 첫 번째 포커스 가능 요소로 이동          
          $(this).data('trigger-element', document.activeElement);
          if ($.fn.DataTable.isDataTable('#tbl_help_chain')) {
            $('#tbl_help_chain').DataTable().destroy();
          }  
          if ($('#tbl_help_chain').length) {
            $('#tbl_help_chain').DataTable({ 
                processing: true,
                serverSide: true,
                select: true,
                ajax: {
                  url: '/common/getLinkChainList',
                  contentType: 'application/json',
                  dataType: 'JSON',
                  type: 'POST',
                  data: function (postData) {
                    formData = $('#frm_help_chain').serializeObject();
                    Object.assign(postData, formData);
                    return JSON.stringify(postData);
                  },
                },
                columns: [
                    { data: 'chain_nm' },
                    { data: 'biz_no' },
                    { data: 'ceo_nm' },
                    { data: 'chain_tel_no' },  
                ],
                columnDefs: [
                    { targets: 0, width: '100px', className: 'text-left' },
                    { targets: 1, width: '120px', className: 'text-left' },
                    { targets: 2, width: '200px', className: 'text-left' },
                    { targets: 3, width: '100px', className: 'text-center' },
                ],
                order: [[1, 'desc']],
                paging: true,
                lengthChange: false,
                searching: false,
                ordering: true,
                autoWidth: false,
                responsive: true,
                scrollCollapse: true,
                pageLength: 10,
                scrollY: '380px',
                info: false,
                language: {
                  emptyTable: '데이터가 없습니다.',
                  search: '검색:',
                  zeroRecords: '일치하는 데이터가 없습니다.',
                  loadingRecords: '로딩중...',
                  processing: '처리중...',
                },
            });
          } else {
            console.error('tbl_help_chain 테이블을 찾을 수 없습니다.');
          }
           $(this).find('button:not([disabled]), input:not([disabled])').first().focus();           
        }); 

        $('#btn_search_chain').click(function () {
          tbl_help_chain.ajax.reload();
        });

        $('#tbl_help_chain').on('click', 'tr', function () {
          if ($(this).hasClass('selected')) {
            $(this).removeClass('selected');
          } else {
            $('#tbl_help_chain').find('tr.selected').removeClass('selected');
            $(this).addClass('selected');
          }
        });

        $('#tbl_help_chain').on('dblclick', 'tr', function () { 
          var data = $('#tbl_help_chain').DataTable().row(this).data();
          if (data) {
            $('#link_chain_no').val(data.chain_no);
            $('#link_chain_nm').val(data.chain_nm);
            $('#modal_help_chain').modal('hide');
          }
        });
         
      });
    </script>
  </head>
  <div class="content">
    
    <div class="row g-3 mb-2">
      <div class="col-lg-8">
        <div class="card">
          <div class="card-header">
            <div class="row flex-between-end">
              <div class="col-auto align-self-center">
                <h4 class="mb-0">가맹점 목록</h4>
              </div>
              <div class="col-lg-8">
                <form id="frm_sch" name="frm_sch" onsubmit="return false;" novalidate="">
                  <div class="input-group input-group-sm px-3">
                    <select class="form-select form-control-sm" id="sch_corp_cd" name="sch_corp_cd" style="width: 75px">
                      <option value="">여신사</option>
                    </select>
                    <select class="form-select form-control-sm" id="sch_agency_no" name="sch_agency_no" style="width: 75px">
                      <option value="">대리점</option>
                    </select>
                    <select class="form-select form-control-sm" id="schgb_chain" name="schgb_chain" style="width: 80px">
                      <option value="">선택</option>
                      <option value="schgb_chain_no">가맹점 번호</option>
                      <option value="schgb_chain_nm">가맹점 명</option>
                      <option value="schgb_biz_no">사업자 번호</option>
                      <option value="schgb_ceo_nm">대표자 명</option>
                    </select>
                    <input type="text" class="form-control form-control-sm" id="schgb_chain_val" name="schgb_chain_val" style="width: 15%" />
                    <select class="form-select form-control-sm" id="sch_svc_stat" name="sch_svc_stat" style="width: 50px">
                      <option value="">계약</option>                      
                    </select>
                    <span class="input-group-btn"><button type="button" class="btn btn-primary btn-sm" id="btn_search" name="btn_search">조회</button></span>
                  </div>
                </form>
              </div>
            </div>
          </div>
          
          <div class="card-body pt-0 px-0" style="padding-top: 0px">
            <div class="table-responsive scrollbar">
              <table class="table table-striped table-sm fs-9 mb-0 table-hover" id="tbl_chain">
                <thead>
                  <tr>
                    <th class="text-center">가맹점 NO</th>
                    <th class="text-center">가맹점 명</th>
                    <th class="text-center">사업자 번호</th>                    
                    <th class="text-center">대표자 명</th>
                    <th class="text-center">대표 연락처</th>
                    <th class="text-center">한도금액</th>
                    <th class="text-center">즉결잔고</th>
                    <th class="text-center">여신사</th>
                    <th class="text-center">대리점</th> 
                    <th class="text-center">계약</th>
                    <th class="text-center">출금</th>                    
                  </tr>
                </thead>
                <tbody class="list"></tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
      <div class="col-lg-4">
        <div class="card">
          <!-- <div class="card-header">
            <div class="row flex-between-end">
              <div class="col-auto align-self-center">
                <h5 class="mb-0">가맹점 상세</h5>
              </div>
            </div>
          </div> -->
          <div class="card-body">
            <div class="min-vh-50">
              <ul class="nav nav-tabs" id="myTab" role="tablist">
                <li class="nav-item">
                    <a class="nav-link active" id="chain_info_tab" data-bs-toggle="tab" href="#tab_chain_info" role="tab" aria-controls="tab_chain_info" aria-selected="true">일반 정보</a>
                </li>
                <li class="nav-item"><a class="nav-link" id="cont_info_tab" data-bs-toggle="tab" href="#tab_cont_info" role="tab" aria-controls="tab_cont_info" aria-selected="false">계약 정보</a></li>
                <li class="nav-item"><a class="nav-link" id="van_info_tab" data-bs-toggle="tab" href="#tab_van_info" role="tab" aria-controls="tab_van_info" aria-selected="false">VAN 정보</a></li>
                <li class="nav-item"><a class="nav-link" id="card_info_tab" data-bs-toggle="tab" href="#tab_card_info" role="tab" aria-controls="tab_card_info" aria-selected="false">매입 정보</a></li>
                <li class="nav-item"><a class="nav-link" id="link_chain_tab" data-bs-toggle="tab" href="#tab_link_chain" role="tab" aria-controls="tab_link_chain" aria-selected="false">연관가맹점</a></li>
                <li class="nav-item"><a class="nav-link" id="file_info_tab" data-bs-toggle="tab" href="#tab_file_info" role="tab" aria-controls="tab_file_info" aria-selected="false">파일 관리</a></li>
              </ul>
              <div class="tab-content border border-top-2 p-3" id="myTabContent">                
                <!-- 일반정보 TAB ----------------------------------------------------------------------------------------------------------------- -->    
                <div class="tab-pane fade show active" id="tab_chain_info" role="tabpanel" aria-labelledby="chain_info_tab">
                  <form class="needs-validation" id="frm_chain_info" name="frm_chain_info" onsubmit="return false;" method="post" novalidate=""> 
                    <div class="row mb-1">
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-0">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="corp_cd">여신사</label>  
                          <div class="col-sm-8">
                            <select class="form-select form-control-sm" id="corp_cd" name="corp_cd" required>
                              <option value="">여신사</option>
                            </select>  
                          </div>         
                        </div>
                      </div>
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="agency_no">대리점</label>  
                          <div class="col-sm-8">
                            <select class="form-select form-control-sm" id="agency_no" name="agency_no" required>
                              <option value="">대리점</option>
                            </select>    
                          </div>
                        </div>
                      </div>
                    </div>    
                    <div class="row mb-1">
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="chain_no">가맹점번호</label>                      
                          <div class="col-sm-8">
                            <input class="form-control form-control-sm bg-light" id="chain_no" type="text" name="chain_no" readonly="readonly" />
                          </div>     
                        </div>
                      </div>
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="chain_nm">가맹점 명</label>                      
                          <div class="col-sm-8">
                            <input class="form-control form-control-sm" id="chain_nm" type="text" name="chain_nm"  maxlength="20" required />    
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="row mb-1">
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="biz_no">사업자 번호</label>                      
                          <div class="col-sm-8">
                            <input class="form-control form-control-sm" id="biz_no" type="text" name="biz_no" maxlength="15" required />                    
                          </div>     
                        </div>
                      </div>
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="law_no">법인 번호</label>  
                          <div class="col-sm-8">
                            <input class="form-control form-control-sm" id="law_no" type="text" name="law_no" maxlength="15" />
                          </div>   
                        </div>
                      </div>
                    </div> 
                    <div class="row mb-1">
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="upjong">업종</label>                      
                          <div class="col-sm-8">
                            <input class="form-control form-control-sm" id="upjong" type="text" name="upjong" maxlength="30" />               
                          </div>     
                        </div>
                      </div>
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="uptae">업태</label>  
                          <div class="col-sm-8">
                            <input class="form-control form-control-sm" id="uptae" type="text" name="uptae" maxlength="30" />
                          </div>   
                        </div>
                      </div>
                    </div>
                    
                    <div class="row mb-1">
                      <div class="input-group input-group-sm mb-1">
                        <label class="col-sm-2 col-form-label col-form-label-sm" for="chain_tel_no">연락처</label>                      
                        <div class="col-sm-10">
                          <input class="form-control form-control-sm" id="chain_tel_no" type="text" name="chain_tel_no" placeholder="010-000-0000" istyle="phone" required /> 
                        </div>     
                      </div> 
                    </div>
                    <div class="row mb-1"> 
                      <div class="input-group input-group-sm mb-1">
                        <label class="col-sm-2 col-form-label col-form-label-sm" for="uptae">eMail</label>  
                        <div class="col-sm-10">
                          <input class="form-control form-control-sm" id="email" type="email" name="email" placeholder="example@email.com" istyle="email"/> 
                        </div>   
                      </div> 
                    </div>
                    <div class="row mb-1"> 
                      <div class="input-group input-group-sm mb-2"> 
                        <label class="col-sm-2 col-form-label col-form-label-sm" for="addr">가맹점 주소</label>                     
                        <div class="col-sm-10">
                          <div class="input-group input-group-sm">
                            <input type="hidden" class="form-control form-control-sm" id="chain_zip_no" name="chain_zip_no" required />
                            <input type="text" class="form-control form-control-sm" id="chain_addr" name="chain_addr" readonly="readonly" required />
                            <button type="button" class="btn btn-primary" onclick="execDaumPostcode('corp')">주소검색</button>
                          </div>                    
                          <!-- 상세 주소 입력 -->
                          <input type="text" class="form-control form-control-sm mt-2" id="chain_addr_dtl" name="chain_addr_dtl" placeholder="상세 주소" required />
                        </div>
                      </div>
                    </div>  
                    <div class="row mb-3 mt-1 mb-1 fw-bold fs-8 border-bottom pb-1"></div> 
                    <div class="row mb-1">
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="ceo_id">대표자 ID</label>                     
                          <div class="col-sm-8">
                            <div class="input-group input-group-sm">
                              <input type="text" class="form-control form-control-sm" id="ceo_id" name="ceo_id" required maxlength="20" />
                              <input id="ceo_id_dup_chk" type="hidden" name="ceo_id_dup_chk"/>
                              <button type="button" class="btn btn-primary" id="btn_dupchk">중복</button>
                            </div>
                          </div> 
                        </div>
                      </div>  
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="ceo_pwd">PASSWORD</label>                  
                          <div class="col-sm-8">
                            <input class="form-control form-control-sm" id="ceo_pwd" type="password" name="ceo_pwd" maxlength="20" required /> 
                          </div>
                        </div> 
                      </div>
                    </div> 
                    <div class="row mb-1">  
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="ceo_nm">대표자 명</label>                  
                          <div class="col-sm-8">
                            <input class="form-control form-control-sm" id="ceo_nm" type="text" name="ceo_nm" maxlength="20" required /> 
                          </div>     
                        </div>
                      </div>
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="ceo_birth_dt">생년월일</label>
                          <div class="col-sm-8">
                            <input class="form-control form-control-sm" id="ceo_birth_dt" type="text" name="ceo_birth_dt" istyle="date" maxlength="10" required />
                          </div>   
                        </div>
                      </div> 
                    </div>
                    
                    <div class="row mb-1">                           
                      <div class="input-group input-group-sm mb-1">
                        <label class="col-sm-2 col-form-label col-form-label-sm" for="ceo_tel_no">연락처</label>                  
                        <div class="col-sm-10">
                          <input class="form-control form-control-sm" id="ceo_tel_no" type="text" name="ceo_tel_no" placeholder="010-000-0000" istyle="phone" required /> 
                        </div>                  
                      </div>
                    </div>
                    <div class="row mb-1"> 
                      <div class="input-group input-group-sm mb-1"> 
                        <label class="col-sm-2 col-form-label col-form-label-sm" for="ceo_addr">대표자 주소</label>                     
                        <div class="col-sm-10">
                          <div class="input-group input-group-sm">
                            <input type="hidden" class="form-control form-control-sm" id="ceo_zip_no" name="ceo_zip_no" required />
                            <input type="text" class="form-control form-control-sm" id="ceo_addr" name="ceo_addr" readonly="readonly" required />
                            <button type="button" class="btn btn-primary" onclick="execDaumPostcode('ceo')">주소검색</button>
                          </div> 
                          <input type="text" class="form-control form-control-sm mt-2" id="ceo_addr_dtl" name="ceo_addr_dtl" placeholder="상세 주소" required />
                        </div>
                      </div>
                    </div>   
                    <div class="row mb-1">
                      <div class="input-group input-group-sm mb-1">
                        <label class="col-sm-2 col-form-label col-form-label-sm" for="remark">Memo</label>
                        <div class="col-sm-10">
                          <textarea class="form-control"  id="remark" rows="2" name="remark"></textarea> 
                        </div>
                      </div>
                    </div>
                    <div class="row mb-1"> 
                      <div class="input-group input-group-sm mb-1"> 
                        <label class="col-sm-2 col-form-label col-form-label-sm" for="addr">수정자 / 일</label>                     
                        <div class="col-sm-10">
                          <div class="input-group input-group-sm">
                            <input type="text" class="form-control form-control-sm" id="upt_user_id" name="upt_user_id" readonly="readonly" disabled />
                            <input type="text" class="form-control form-control-sm" id="upt_dttm" name="upt_dttm" readonly="readonly" disabled /> 
                          </div>                    
                        </div>
                      </div>   
                    </div>
                    <div class="card-footer">  
                      <p class="text-end pb-1 mb-1 pd-1">
                        <button class="btn btn-info text-end" id="btn_clear"><i class="fa fa-check"></i>신규</button>
                        <button class="btn btn-primary text-end" id="btn_update" style="display: none"><i class="fa fa-paste"></i>저장</button>
                        <button class="btn btn-primary text-end" id="btn_save"><i class="fa fa-paste"></i>저장</button>
                      </p>
                    </div>
                  </form>  
                </div>     
                <!-- 계약정보 TAB ----------------------------------------------------------------------------------------------------------------- -->               
                <div class="tab-pane fade" id="tab_cont_info" role="tabpanel" aria-labelledby="cont_info_tab">
                  <form class="needs-validation" id="frm_cont_info" name="frm_cont_info" onsubmit="return false;" method="post" novalidate="">
                    <input id="cont_chain_no" type="hidden" name="cont_chain_no" />
                    <div class="row mb-1">
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="cont_dt">계약일</label>  
                          <div class="col-sm-8">
                            <input class="form-control form-control-sm" id="cont_dt" name = "cont_dt" type="text" istyle="date" required>
                          </div>         
                        </div>
                      </div>
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="svc_stat">계약</label>  
                          <div class="col-sm-8">
                            <select class="form-select form-control-sm" id="svc_stat" name="svc_stat"  required>
                              <option value="">계약상태</option>
                            </select>
                          </div>
                        </div>
                      </div>
                    </div>                    
                    <div class="row mb-1">
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="svc_start_dt">시작일</label>  
                          <div class="col-sm-8">
                            <input class="form-control form-control-sm" id="svc_start_dt" name = "svc_start_dt" type="text" istyle="date" required />
                          </div>         
                        </div>
                      </div>
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="svc_end_dt">종료일</label>  
                          <div class="col-sm-8">
                            <input class="form-control form-control-sm" id="svc_end_dt" name = "svc_end_dt" type="text" placeholder="yyyy-mm-dd" istyle="date" />
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="row mb-1">
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="svc_fee_rate">정산 수수료</label>  
                          <div class="col-sm-8">
                            <div class="input-group input-group-sm mb-1">
                              <input class="form-control form-control-sm text-end" id="svc_fee_rate" type="text" name="svc_fee_rate" placeholder="00.0" istyle="float" maxlength="4" required />
                              <span class="input-group-text">%</span>
                            </div>
                          </div>         
                        </div>
                      </div>
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="etc_fee_rate">기타 수수료</label>  
                          <div class="col-sm-8">
                            <div class="input-group input-group-sm mb-1">
                              <input class="form-control form-control-sm text-end" id="etc_fee_rate" type="text" name="etc_fee_rate" placeholder="00.0" istyle="float" maxlength="4" required />
                              <span class="input-group-text">%</span>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="row mb-1">
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="crd_fee_rate">여신 수수료</label>  
                          <div class="col-sm-8">
                            <div class="input-group input-group-sm mb-1">
                              <input class="form-control form-control-sm text-end" id="crd_fee_rate" type="text" name="crd_fee_rate" placeholder="00.0" istyle="float" maxlength="4" required />
                              <span class="input-group-text">%</span>
                            </div>
                          </div>         
                        </div>
                      </div>
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="crd_delay_rate">연체 수수료</label>  
                          <div class="col-sm-8">
                            <div class="input-group input-group-sm mb-1">
                              <input class="form-control form-control-sm text-end" id="crd_delay_rate" type="text" name="crd_delay_rate" placeholder="00.0" istyle="float" maxlength="4" required />
                              <span class="input-group-text">%</span>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="row mb-1">
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="tot_limit_amt">약정 한도액</label>  
                          <div class="col-sm-8">
                            <input class="form-control form-control-sm text-end" id="tot_limit_amt" type="text" name="tot_limit_amt" placeholder="100,000,000" istyle="amount" maxlength="13" required />
                          </div>         
                        </div>
                      </div>
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="unit_limit_amt">건 한도액</label>  
                          <div class="col-sm-8">
                            <input class="form-control form-control-sm  text-end" id="unit_limit_amt" type="text" name="unit_limit_amt" placeholder="100,000,000" istyle="amount" maxlength="13" required />
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="row mb-1">
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="day_use_rate">일 한도율</label>  
                          <div class="col-sm-8">
                            <div class="input-group input-group-sm mb-1">
                              <input class="form-control form-control-sm text-end" id="day_use_rate" type="text" name="day_use_rate" placeholder="00.0" istyle="float" maxlength="4" required />
                              <span class="input-group-text">%</span>
                            </div>
                          </div>         
                        </div>
                      </div>
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="day_use_amt">일일 한도액</label>  
                          <div class="col-sm-8">
                            <input class="form-control form-control-sm  text-end" id="day_use_amt" type="text" name="day_use_amt" placeholder="100,000,000" istyle="amount" maxlength="13" required />
                          </div>
                        </div>
                      </div>
                    </div> 
                    <!-- 입금계좌 ----------------------------------------------------------------------------------------------------------------- -->
                    <div class="mt-2 mb-2 fw-bold fs-8 border-bottom pb-1 text-primary"></div>
                    
                    <div class="row mb-1">
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="abank_cd">입금 은행</label>  
                          <div class="col-sm-8">
                            <select class="form-select form-select-sm" id="abank_cd" placeholder="" name="abank_cd" required>
                              <option value="">선택</option>
                            </select>                        
                          </div>         
                        </div>
                      </div>
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="abank_depositor">예금주</label>  
                          <div class="col-sm-8">
                            <input class="form-control form-control-sm" id="abank_depositor" type="text" name="abank_depositor" required maxlength="20"/>      
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="row mb-1">
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="abank_account_no">계좌 번호</label>  
                          <div class="col-sm-8">
                            <input class="form-control form-control-sm" id="abank_account_no" type="text" name="abank_account_no"  istyle="number" maxlength="15" required />      
                          </div>         
                        </div>
                      </div>
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="abank_pwd">비밀번호</label>  
                          <div class="col-sm-8">
                            <input class="form-control form-control-sm" id="abank_pwd" type="text" name="abank_pwd" maxlength="4" />      
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="row mb-1">
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="abank_account_tp">계좌유형</label>  
                          <div class="col-sm-8">
                            <select class="form-select form-select-sm" id="abank_account_tp" placeholder="" name="abank_account_tp" >
                              <option value="">선택</option>
                            </select>                      
                          </div>
                        </div>
                      </div>    
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="abank_speed_yn">스피드계좌</label>  
                          <div class="col-sm-8">
                            <select class="form-select form-select-sm" id="abank_speed_yn" placeholder="" name="abank_speed_yn" >
                              <option value="Y">등록</option>
                              <option value="N">미등록</option>
                            </select>                      
                          </div>
                        </div>
                      </div>                    
                    </div>
                    <div class="row mb-1">
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="abank_search_id">조회 ID</label>  
                          <div class="col-sm-8">
                            <input class="form-control form-control-sm" id="abank_search_id" type="text" name="abank_search_id"  maxlength="20" />      
                          </div>         
                        </div>
                      </div>
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="abank_search_pwd">조회PWD</label>  
                          <div class="col-sm-8">
                            <input class="form-control form-control-sm" id="abank_search_pwd" type="text" name="abank_search_pwd" maxlength="20" />      
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="row mb-1" id="knbank_info" name="knbank_info">
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="abank_link_agree_dt">경남 동의일</label>  
                          <div class="col-sm-8">
                            <input class="form-control form-control-sm" id="abank_link_agree_dt" name = "abank_link_agree_dt" type="text" istyle="date" readonly="readonly">                      
                          </div>         
                        </div>
                      </div>
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="abank_link_stat">연동상태</label>                            
                          <div class="col-sm">
                            <select class="form-select form-select-sm" id="abank_link_stat" placeholder="" name="abank_link_stat" >
                              <option value="">선택</option>
                            </select>  
                          </div>                            
                          <span class="input-group-btn"><button type="button" class="btn btn-primary btn-sm" id="btn_bank_link_stat_change" name="btn_bank_link_stat_change">변경</button></span> 
                        </div>  
                      </div>
                    </div>  
                    
                    <!-- 출금계좌 ----------------------------------------------------------------------------------------------------------------- -->
                    <div class="mt-2 mb-2 fw-bold fs-8 border-bottom pb-1 text-primary"></div>                    
                    <div class="row mb-1">
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="bbank_cd">출금 은행</label>  
                          <div class="col-sm-8">
                            <select class="form-select form-select-sm" id="bbank_cd" name="bbank_cd" required>
                              <option value="">선택</option>
                            </select>                        
                          </div>         
                        </div>
                      </div>
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="bbank_account_no">계좌번호</label>  
                          <div class="col-sm-8">
                            <input class="form-control form-control-sm" id="bbank_account_no" type="text" name="bbank_account_no" istyle="number" maxlength="15" />
                          </div>
                        </div>
                      </div>                      
                    </div>
                    <div class="row mb-1">
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="bbank_depositor">예금주</label>  
                          <div class="col-sm-8">
                            <input class="form-control form-control-sm" id="bbank_depositor" type="text" name="bbank_depositor" maxlength="20" />      
                          </div>
                        </div>
                      </div>
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="remit_trans_fee">이체수수료</label>  
                          <div class="col-sm-8">
                            <input class="form-control form-control-sm" id="remit_trans_fee" type="text" name="remit_trans_fee" istyle="amount" maxlength="5" required/>      
                          </div>
                        </div>
                      </div>             
                    </div>
                    <div class="row mb-1">
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="remit_stat">출금 상태</label>  
                          <select class="form-select form-select-sm" id="remit_stat" placeholder="" name="remit_stat" >
                            <option value="">선택</option>
                            <option value="Y">출금</option>
                            <option value="N">정지</option>
                          </select>
                        </div>
                      </div>  
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="remit_start_dt">출금게시일</label>  
                          <div class="col-sm-8">
                            <input class="form-control form-control-sm" id="remit_start_dt" name = "remit_start_dt" type="text" placeholder="yyyy-mm-dd" istyle="date" readonly="readonly">                      
                          </div>         
                        </div>
                      </div>                      
                    </div>     
                    <div class="row mb-1">
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="remit_over_stat">과입 출금</label>  
                          <select class="form-select form-select-sm" id="remit_over_stat" placeholder="" name="remit_over_stat" >
                            <option value="">선택</option>
                            <option value="Y">출금</option>
                            <option value="N">정지</option>
                          </select>
                        </div>
                      </div>      
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="remit_over_stat_cd">정지사유</label>  
                          <select class="form-select form-select-sm" id="remit_over_stat_cd" placeholder="" name="remit_over_stat_cd" disabled>
                            <option value="">선택</option>
                          </select>
                        </div>
                      </div>                                            
                    </div> 
                    <div class="row mb-1">
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="risk_stat">RM 상태</label>  
                          <select class="form-select form-select-sm" id="risk_stat" placeholder="" name="risk_stat" >
                            <option value="">선택</option>
                            <option value="S">정상</option>
                            <option value="W">위험</option>
                          </select>
                        </div>
                      </div>      
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="risk_reason_cd">리스크 사유</label>  
                          <select class="form-select form-select-sm" id="risk_reason_cd" placeholder="" name="risk_reason_cd" disabled>
                            <option value="">선택</option>
                          </select>
                        </div>
                      </div>                                            
                    </div> 
                    <!-- 기타 속성 ----------------------------------------------------------------------------------------------------------------- -->
                    <div class="mt-2 mb-2 fw-bold fs-8 border-bottom pb-1 text-primary"></div>
                    
                    <div class="row mb-1">
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="cardsales_id">여신협 ID</label>  
                          <div class="col-sm-8">
                            <input class="form-control form-control-sm" id="cardsales_id" type="text" name="cardsales_id" maxlength="20" />                            
                          </div>         
                        </div>
                      </div>
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="cardsales_pwd">여신협PWD</label>  
                          <div class="col-sm-8">
                            <input class="form-control form-control-sm" id="cardsales_pwd" type="text" name="cardsales_pwd" maxlength="20" />
                          </div>
                        </div>
                      </div>                      
                    </div>
                    <div class="row mb-1"> 
                      <div class="input-group input-group-sm mb-2">
                        <label class="col-sm-2 col-form-label col-form-label-sm" for="use_yn">사용여부</label>
                        <div class="col-sm-10">
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" id="use_yn_y" type="radio" name="use_yn" value="Y" required />
                            <label class="form-check-label" for="use_yn_y">예</label>
                          </div>
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" id="use_yn_n" type="radio" name="use_yn" value="N" required />
                            <label class="form-check-label" for="use_yn_n">아니요</label>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="card-footer">  
                      <p class="text-end pb-1 mb-1 pd-1">
                        <button class="btn btn-primary text-end" id="btn_cont_update"><i class="fa fa-paste"></i>저장</button>
                      </p>
                    </div>                       
                  </form>  
                </div>
                
                <!-- VAN 정보보 TAB ----------------------------------------------------------------------------------------------------------------- -->
                <div class="tab-pane fade" id="tab_van_info" role="tabpanel" aria-labelledby="van_info_tab">                                     
                  <div class="table-responsive scrollbar">
                    <table class="table table-striped table-sm fs-9 mb-0 table-hover" id="tbl_van">
                      <thead class="bg-200">
                        <tr>
                          <th class="text-center" style="width: 90px;">VAN CD</th>
                          <th class="text-center" style="width: 120px;">VAN 사 명</th>
                          <th class="text-center" style="width: 120px;">VAN_ID</th>
                          <th class="text-center" style="width: 80px;">사용</th>
                        </tr>
                      </thead>
                      <tbody class="list"></tbody>
                    </table>
                  </div> 
                  <div class="mt-3 mb-3 fw-bold fs-8 border-bottom pb-1 text-primary">상세정보</div>
                  <form class="needs-validation" id="frm_van_info" name="frm_van_info" onsubmit="return false;" method="post" novalidate=""> 
                    <input id="van_seq" type="hidden" name="van_seq" />
                    <input id="van_chain_no" type="hidden" name="van_chain_no" />
                    <div class="row mb-1">
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="van_cd">VAN 사</label>
                          <div class="col-sm-8">
                            <select class="form-select form-select-sm" id="van_cd" name="van_cd" required>
                              <option value="">선택</option> 
                            </select>
                          </div>
                        </div>
                      </div>
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="van_use_yn">상태</label>
                          <div class="col-sm-8">
                            <select class="form-select form-select-sm" id="van_use_yn" name="van_use_yn" required>
                              <option value="">선택</option>
                              <option value="Y">운영</option>
                              <option value="N">종료</option>
                            </select>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="row mb-1">
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="van_id">VAN_ID</label>
                          <div class="col-sm-8">
                            <div class="input-group input-group-sm">
                              <input class="form-control form-control-sm" id="van_id" type="text" name="van_id" maxlength="20" required />
                              <input id="van_id_dup_chk" type="hidden" name="van_id_dup_chk"/>
                              <button type="button" class="btn btn-primary" id="btn_van_dupchk">중복</button>
                            </div>                            
                          </div>
                        </div>
                      </div>
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="van_pwd">VAN_PWD</label>
                          <div class="col-sm-8">
                            <input class="form-control form-control-sm" id="van_pwd" type="text" name="van_pwd" maxlength="20" required />
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="row mb-1">
                      <div class="input-group input-group-sm mb-2">
                        <label class="col-sm-2 col-form-label col-form-label-sm" for="term_id">단말기 ID</label>
                        <div class="col-sm-10">
                          <textarea class="form-control"  id="term_id" rows="2" name="term_id"></textarea> 
                        </div>
                      </div>
                    </div>                    
                    <div class="row mb-1"> 
                      <div class="input-group input-group-sm mb-2"> 
                        <label class="col-sm-2 col-form-label col-form-label-sm" for="addr">수정자 / 일</label>
                        <div class="col-sm-10">
                          <div class="input-group input-group-sm">
                            <input type="text" class="form-control form-control-sm" id="van_upt_user_id" name="van_upt_user_id" readonly="readonly" disabled />
                            <input type="text" class="form-control form-control-sm" id="van_upt_dttm" name="van_upt_dttm" readonly="readonly" disabled /> 
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="card-footer">
                      <p class="text-end pb-1 mb-1 pd-1">
                        <button class="btn btn-info text-end" id="btn_van_clear"><i class="fa fa-check"></i>신규</button>
                        <button class="btn btn-primary text-end" id="btn_van_update" style="display: none"><i class="fa fa-paste"></i>저장</button>
                        <button class="btn btn-primary text-end" id="btn_van_create"><i class="fa fa-paste"></i>저장</button>
                      </p>
                    </div>
                  </form>
                </div>

                <!-- CARD 정보 TAB ----------------------------------------------------------------------------------------------------------------- -->                               
                <div class="tab-pane fade" id="tab_card_info" role="tabpanel" aria-labelledby="card_info_tab">                   
                  <div class="row mb-0">
                    <div class="table-responsive scrollbar">
                      <table class="table table-striped table-sm fs-9 mb-0 table-hover" id="tbl_card">
                        <thead>
                          <tr>
                                <th class="text-center" style="width: 120px;">매입사</th>
                                <th class="text-center" style="width: 70px;">신용</th>
                                <th class="text-center" style="width: 70px;">체크</th>
                                <th class="text-center" style="width: 70px;">해외</th>
                                <th class="text-center" style="width: 70px;">주기</th>
                                <th class="text-center" style="width: 70px;">확인</th>
                                <th class="text-center" style="width: 70px;">사용</th>
                          </tr>
                        </thead>
                        <tbody class="list"></tbody>
                      </table>
                    </div>
                  </div>
                  
                  <div class="mt-3 mb-3 fw-bold fs-8 border-bottom pb-1 text-primary">상세정보</div> 
                  <form class="needs-validation" id="frm_card_info" name="frm_card_info" onsubmit="return false;" method="post" novalidate=""> 
                    <input id="card_seq" type="hidden" name="card_seq" />
                    <input id="card_chain_no" type="hidden" name="card_chain_no" />
                    <div class="row mb-1">
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="card_acq">매입사</label>
                          <div class="col-sm-8">
                            <select class="form-select form-select-sm" id="card_acq" name="card_acq" required>
                              <option value="">선택</option> 
                            </select>
                          </div>
                        </div>
                      </div>
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="depo_chk">입금확인</label>
                          <div class="col-sm-8">
                            <select class="form-select form-select-sm" id="depo_chk" name="depo_chk" required>
                              <option value="">선택</option>
                              <option value="Y">확인</option>
                              <option value="N">미확인</option>
                            </select>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="row mb-1">
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="card_reg_no">가맹번호</label>
                          <div class="col-sm-8">
                            <div class="input-group input-group-sm">
                              <input class="form-control form-control-sm" id="card_reg_no" type="text" name="card_reg_no" maxlength="20" required />
                              <input id="card_id_dup_chk" type="hidden" name="card_id_dup_chk" />
                              <button type="button" class="btn btn-primary" id="btn_card_dupchk">중복</button>
                            </div>                            
                          </div>
                        </div>
                      </div>
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="card_use_yn">상태</label>
                          <div class="col-sm-8">
                            <select class="form-select form-select-sm" id="card_use_yn" name="card_use_yn" required>
                              <option value="">선택</option>
                              <option value="Y">운영</option>
                              <option value="N">종료</option>
                            </select>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="row mb-1">
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="card_rate">신용 수수료</label>  
                          <div class="col-sm-8">
                            <div class="input-group">
                              <input class="form-control form-control-sm text-end" id="card_rate" type="text" name="card_rate" placeholder="00.0" istyle="float" maxlength="4" required />
                              <span class="input-group-text">%</span>
                            </div>
                          </div>         
                        </div>
                      </div>
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="check_rate">체크 수수료</label>  
                          <div class="col-sm-8">
                            <div class="input-group">
                              <input class="form-control form-control-sm text-end" id="check_rate" type="text" name="check_rate" placeholder="00.0" istyle="float" maxlength="4" required />
                              <span class="input-group-text">%</span>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="row mb-1">
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="abroad_rate">해외 수수료</label>  
                          <div class="col-sm-8">
                            <div class="input-group">
                              <input class="form-control form-control-sm text-end" id="abroad_rate" type="text" name="abroad_rate" placeholder="00.0" istyle="float" maxlength="4" required />
                              <span class="input-group-text">%</span>
                            </div>
                          </div>         
                        </div>
                      </div>
                      <div class="col-sm-6">
                        <div class="input-group input-group-sm mb-1">
                          <label class="col-sm-4 col-form-label col-form-label-sm" for="card_in_cycle">입금 주기</label>  
                          <div class="col-sm-8">
                              <input class="form-control form-control-sm text-end" id="card_in_cycle" type="text" name="card_in_cycle" placeholder="0" istyle="number" maxlength="2" />
                          </div>
                        </div>
                      </div>
                    </div> 
                    <div class="row mb-1">
                      <div class="input-group input-group-sm mb-2">
                        <label class="col-sm-2 col-form-label col-form-label-sm" for="card_memo">메 모</label>
                        <div class="col-sm-10">
                          <textarea class="form-control"  id="card_memo" rows="2" name="card_memo"></textarea> 
                        </div>
                      </div>
                    </div>                    
                    <div class="row mb-1"> 
                      <div class="input-group input-group-sm mb-2"> 
                        <label class="col-sm-2 col-form-label col-form-label-sm" for="addr">수정자 / 일</label>
                        <div class="col-sm-10">
                          <div class="input-group input-group-sm">
                            <input type="text" class="form-control form-control-sm" id="card_upt_user_id" name="card_upt_user_id" readonly="readonly" disabled />
                            <input type="text" class="form-control form-control-sm" id="card_upt_dttm" name="card_upt_dttm" readonly="readonly" disabled /> 
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="card-footer">  
                      <p class="text-end pb-1 mb-1 pd-1">
                        <button class="btn btn-info text-end" id="btn_card_clear"><i class="fa fa-check"></i>신규</button>
                        <button class="btn btn-primary text-end" id="btn_card_update" style="display: none"><i class="fa fa-paste"></i>저장</button>
                        <button class="btn btn-primary text-end" id="btn_card_create"><i class="fa fa-paste"></i>저장</button>
                      </p>
                    </div>
                  </form>  
                </div>  

                <!-- 연관가맹점점 정보 TAB ----------------------------------------------------------------------------------------------------------------- -->                               
                <div class="tab-pane fade" id="tab_link_chain" role="tabpanel" aria-labelledby="link_chain_tab">                   
                  <div class="row mb-0">
                    <div class="table-responsive scrollbar">
                      <table class="table table-striped table-sm fs-9 mb-0 table-hover" id="tbl_link_chain">
                        <thead>
                          <tr>
                                <th class="text-center" style="width: 120px;">가맹점 코드</th>
                                <th class="text-center" style="width: 150px;">가맹점 명</th>
                                <th class="text-center" style="width: 90px;">대표자 명</th>
                                <th class="text-center" style="width: 120px;">연락처</th>                                
                          </tr>
                        </thead>
                        <tbody class="list"></tbody>
                      </table>
                    </div>
                  </div>                  
                  <div class="mt-3 mb-3 fw-bold fs-8 border-bottom pb-1 text-primary">상세정보</div> 
                  <form class="needs-validation" id="frm_link_chain" name="frm_link_chain" onsubmit="return false;" method="post" novalidate="">                     
                    <div class="row mb-1">
                      <div class="input-group input-group-sm mb-1">
                        <label class="col-sm-3 col-form-label col-form-label-sm" for="link_chain_no">연관가맹점</label>
                        <div class="col-sm-9">
                          <div class="input-group input-group-sm">
                            <input class="form-control form-control-sm" id="link_org_chain_no" type="hidden" name="link_org_chain_no" />                            
                            <input class="form-control form-control-sm" id="link_chain_no" type="hidden" name="link_chain_no" />                            
                            <input class="form-control form-control-sm  bg-light" id="link_chain_nm" type="text" name="link_chain_nm" maxlength="20" readonly="readonly" required />
                            <button type="button" class="btn btn-primary" id="btn_help_chain">찾기</button>
                          </div>                            
                        </div>
                      </div>
                    </div>
                    <div class="row mb-1">
                      <div class="input-group input-group-sm mb-1">
                        <label class="col-sm-3 col-form-label col-form-label-sm" for="link_memo">메 모</label>
                        <div class="col-sm-9">
                          <textarea class="form-control"  id="link_memo" rows="2" name="link_memo"></textarea> 
                        </div>
                      </div>
                    </div>
                    <div class="row mb-1">
                      <div class="input-group input-group-sm mb-1">
                        <label class="col-sm-3 col-form-label col-form-label-sm" for="link_use_yn">운영 상태</label>
                        <div class="col-sm-9">
                          <select class="form-select form-select-sm" id="link_use_yn" name="link_use_yn" required>
                            <option value="Y">운영</option>
                            <option value="N">종료</option>
                          </select>
                        </div>
                      </div>
                    </div>                      
                    <div class="row mb-1"> 
                      <div class="input-group input-group-sm mb-1"> 
                        <label class="col-sm-3 col-form-label col-form-label-sm" for="addr">수정자 / 일</label>
                        <div class="col-sm-9">
                          <div class="input-group input-group-sm">
                            <input type="text" class="form-control form-control-sm" id="link_upt_user_id" name="link_upt_user_id" readonly="readonly" disabled />
                            <input type="text" class="form-control form-control-sm" id="link_upt_dttm" name="link_upt_dttm" readonly="readonly" disabled /> 
                          </div>
                        </div>
                      </div>
                    </div> 
                    <div class="card-footer">  
                      <p class="text-end pb-1 mb-1 pd-1">
                        <button class="btn btn-info text-end" id="btn_link_clear"><i class="fa fa-check"></i>신규</button>
                        <button class="btn btn-primary text-end" id="btn_link_update" style="display: none"><i class="fa fa-paste"></i>저장</button>
                        <button class="btn btn-primary text-end" id="btn_link_create"><i class="fa fa-paste"></i>저장</button>
                      </p>
                    </div>
                  </form>  
                </div>

                <!-- File 정보 TAB ----------------------------------------------------------------------------------------------------------------- -->               
                <div class="tab-pane fade" id="tab_file_info" role="tabpanel" aria-labelledby="file_info_tab"> 
                  
                    <div class="table-responsive scrollbar">
                      <table class="table table-striped table-sm fs-9 mb-0 table-hover" id="tbl_file">
                        <thead class="bg-200">
                          <tr>
                            <th class="text-center" style="width: 90px;">파일 구분</th>
                            <th class="text-center" style="width: 150px;">File 명</th>                       
                          </tr>
                        </thead>
                        <tbody class="list"></tbody>
                      </table>
                    </div> 
                    <div class="mt-3 mb-3 fw-bold fs-8 border-bottom pb-1 text-primary">상세정보</div>
                    <form class="needs-validation" id="frm_file_info" name="frm_file_info" onsubmit="return false;" method="post" enctype="multipart/form-data"  novalidate="">                   
                      <input id="file_chain_no" type="hidden" name="file_chain_no" />
                      <input id="file_seq" type="hidden" name="file_seq" /> 
                      <div class="row mb-1">
                        <div class="input-group input-group-sm mb-2">
                          <label class="col-sm-2 col-form-label col-form-label-sm" for="file_gb">구분</label>
                          <div class="col-sm-10">
                            <select class="form-select form-select-sm" id="file_gb" name="file_gb" required>
                              <option value="">선택</option> 
                            </select>
                          </div>
                        </div>
                      </div>  
                      <div class="row mb-1">
                        <label class="col-sm-2 col-form-label col-form-label-sm" for="file_upload">파일</label>
                        <div class="col-sm-10">
                          <input class="form-control form-control-sm" id="file_upload" type="file" name="file_upload" novalidate multiple="multiple" required/>
                          <a id="file_down" style="display:none" target="_blank">Down</a>
                        </div>
                      </div>     
                      <div class="row mb-1"> 
                        <div class="input-group input-group-sm mb-2"> 
                          <label class="col-sm-2 col-form-label col-form-label-sm" for="addr">수정자 / 일</label>
                          <div class="col-sm-10">
                            <div class="input-group input-group-sm">
                              <input type="text" class="form-control form-control-sm" id="file_upt_user_id" name="file_upt_user_id" readonly="readonly" disabled />
                              <input type="text" class="form-control form-control-sm" id="file_upt_dttm" name="file_upt_dttm" readonly="readonly" disabled /> 
                            </div>
                          </div>
                        </div>
                      </div>
                    <div class="card-footer">  
                      <p class="text-end pb-1 mb-1 pd-1">
                        <button class="btn btn-info text-end" id="btn_file_clear"><i class="fa fa-check"></i>신규</button>
                        <button class="btn btn-primary text-end" id="btn_file_delete" style="display: none"><i class="fa fa-paste"></i>삭제</button>
                        <button class="btn btn-primary text-end" id="btn_file_create"><i class="fa fa-paste"></i>저장</button>
                      </p>
                    </div>
                  </form> 
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>      
    </div>    
  </div>  

  <div class="modal fade" id="modal_help_chain" tabindex="-1" aria-labelledby="unprocessedModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-md"> <!-- Changed modal-lg to modal-xl for larger size -->
      <div class="modal-content"> 
        
        <div class="modal-header">
          <div class="row flex-between-end">
            <div class="col-auto align-self-center">
              <h4 class="mb-0">가맹점 찾기</h4>
            </div>
            <div class="col-lg-6">
              <form id="frm_help_chain" name="frm_help_chain" onsubmit="return false;" novalidate="">
                <input type="hidden" id="sch_help_chain_no" name="sch_help_chain_no" />                    
                <div class="input-group input-group-sm px-3">
                  <input type="text" class="form-control form-control-sm" id="sch_help_chain_nm" name="sch_help_chain_nm"/>
                  <span class="input-group-btn"><button type="button" class="btn btn-primary btn-sm" id="btn_search_chain" name="btn_search_chain">조회</button></span>     
                </div>  
              </form>              
            </div>           
          </div>
        </div> 
        <div class="modal-body"> 
          <div class="table-responsive scrollbar">
            <table class="table table-striped table-sm fs-9 mb-0 selectable-table table-hover selectable" id="tbl_help_chain">  
              <thead>
                  <tr>
                    <th class="text-center">가맹점 명</th> 
                    <th class="text-center">사업자 번호</th>
                    <th class="text-center">대표자 명</th>
                    <th class="text-center">연락처</th>   
                  </tr>   
              </thead>
              <tbody class="list"></tbody>
            </table>
          </div>
        </div>
        <div class="modal-footer">           
          <button class="btn btn-secondary" type="button" data-bs-dismiss="modal" aria-label="모달 닫기">닫기</button>
        </div>        
      </div>
    </div>
  </div>
</html>
